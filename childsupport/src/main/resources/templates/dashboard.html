<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" lang="eng">
<head>
    <title>Dashboard - Child Support Payment System</title>
    <link rel="stylesheet" th:href="@{/css/main.css}" />
</head>
<body>
<header>
    <h1>Child Support Payment System</h1>
    <nav>
        <ul>
            <li><a th:href="@{/dashboard}">Dashboard</a></li>
            <li><a th:href="@{/cases}">My Cases</a></li>
            <li><a th:href="@{/payments/history}">Payment History</a></li>
            <li sec:authorize="hasRole('PAYER')"><a th:href="@{/payments/make}">Make Payment</a></li>
            <li sec:authorize="hasRole('ADMIN')"><a th:href="@{/admin}">Admin Panel</a></li>
            <li><a th:href="@{/users/profile}">My Profile</a></li>
            <li>
                <form th:action="@{/logout}" method="post">
                    <button type="submit">Logout</button>
                </form>
            </li>
        </ul>
    </nav>
</header>

<main>
    <section class="dashboard">
        <h2>Welcome, <span th:text="${#authentication.principal.user}">User</span>!</h2>

        <div class="dashboard-summary">
            <div class="summary-card" sec:authorize="hasRole('PAYER')">
                <h3>Payment Summary</h3>
                <p>Monthly Obligation: $<span th:text="${totalMonthlyObligation}">0.00</span></p>
                <p>Next Payment Due: <span th:text="${nextPaymentDate}">N/A</span></p>
                <a th:href="@{/payments/make}" class="btn">Make Payment</a>
            </div>

            <div class="summary-card" sec:authorize="hasRole('PAYEE')">
                <h3>Payment Summary</h3>
                <p>Expected Monthly Income: $<span th:text="${expectedMonthlyIncome}">0.00</span></p>
                <p>Next Expected Payment: <span th:text="${nextExpectedPayment}">N/A</span></p>
            </div>

            <div class="summary-card">
                <h3>Case Summary</h3>
                <p>Active Cases: <span th:text="${activeCasesCount}">0</span></p>
                <a th:href="@{/cases}" class="btn">View Cases</a>
            </div>

            <div class="summary-card">
                <h3>Recent Activity</h3>
                <ul class="activity-list">
                    <li th:each="activity : ${recentActivities}" th:text="${activity}">Activity item</li>
                </ul>
            </div>
        </div>
    </section>
</main>

<footer>
    <p>&copy; 2025 Child Support Payment System</p>
</footer>

<script th:src="@{/js/dashboard.js}"></script>
</body>
</html>
